#
#  Copyright ETH 2025 Zürich, Scientific IT Services
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
#


#############################################################
# JUL Log Levels (must use these exact names) and Log4j mapping
#
# OFF     = no logging                      | Log4j: OFF
# SEVERE  = serious failures, system errors | Log4j: ERROR
# WARNING = potential problems, recoverable | Log4j: WARN
# INFO    = general informational messages   | Log4j: INFO
# CONFIG  = static configuration messages    | Log4j: DEBUG
# FINE    = general debugging/tracing        | Log4j: DEBUG
# FINER   = more detailed tracing            | Log4j: TRACE
# FINEST  = most detailed, very verbose      | Log4j: TRACE
# ALL     = enable all logging               | Log4j: ALL
#############################################################


##############
# GLOBAL HANDLERS
##############

# by default, log everything at INFO or above
.global.level = INFO


# these handlers are bound to the root logger unless overridden below
.global.handlerAliases = defaultFileHandler, consoleHandler

##############
# STDOUT (console) HANDLER
##############

# Handler class that wraps java.util.logging.ConsoleHandler and
# adds PatternFormatter support.  Required ? no implicit default.
consoleHandler.class = ch.ethz.sis.shared.log.standard.handlers.ConsoleHandler

# Lowest severity that will be printed to the console.
# Valid JUL levels: OFF, SEVERE, WARNING, INFO, CONFIG,
#                   FINE, FINER, FINEST, ALL
# Default (when omitted) = inherits the root logger?s level.
consoleHandler.level = INFO

# Layout pattern for console lines, parsed by PatternFormatter.
# No built-in default ? if omitted, PatternFormatter falls back
# to its internal hard-coded pattern.
# Tokens used here:
#   %d   ? timestamp (default format ?yyyy-MM-dd HH:mm:ss,SSS?)
#   %-5p ? log level left-padded to 5 chars (INFO, WARN ?)
#   %t   ? thread name
#   %c   ? full logger name
#   %m   ? log message
#   %n   ? platform line separator
consoleHandler.messagePattern = %d %-5p [%t] %c - %m%n


###############################################################################
# defaultFileHandler ? DailyRollingFileHandler
###############################################################################

# The fully-qualified class of the java.util.logging.Handler to instantiate.
# Required.  No implicit default.
defaultFileHandler.class = ch.ethz.sis.shared.log.standard.handlers.DailyRollingFileHandler

# Path (relative or absolute) of the *active* log file.
# DailyRollingFileHandler will add a ?.yyyy-MM-dd? suffix for the
# day-archive, and ?_<n>? for size archives.
# Default (if omitted): <working-dir>/<alias>.log
defaultFileHandler.logFileName = logs/openbis.log

# Maximum size of the active file in **bytes** before a size-based rollover.
# -1  ? unlimited (never roll by size)
# Any positive integer (e.g. 10 485 760 = 10 MiB) triggers a rollover
# when the file exceeds that threshold.
# Default: -1
defaultFileHandler.maxLogFileSize = 10485760

# How many *archived* files to keep (both day- and size-archives).
# -1  ? keep them all
# 0   ? delete the old file instead of archiving it
# 1+  ? keep only the newest N archives, deleting older ones.
# Default: -1
defaultFileHandler.maxLogRotations = 130

# If true, open the active file in append mode; if false, truncate it
# on every JVM start.  Default: true
defaultFileHandler.append = true

# Minimum severity level this handler will actually write.
# Valid JUL levels: OFF, SEVERE, WARNING, INFO, CONFIG, FINE, FINER, FINEST, ALL
# Default (when omitted): inherits the root level (often INFO).
defaultFileHandler.level = INFO

# Layout pattern understood by PatternFormatter.
# Tokens used here:
#   %d   ? timestamp (default format ?yyyy-MM-dd HH:mm:ss,SSS?)
#   %-5p ? log level left-padded to 5 chars (INFO, WARN ?)
#   %t   ? thread name
#   %c   ? full logger name
#   %m   ? log message
#   %n   ? platform line separator
# No built-in default ? if omitted, PatternFormatter falls back to its
# own hard-coded pattern.
defaultFileHandler.messagePattern = %d %-5p [%t] %c - %m%n



##############
# AUTH FILE HANDLER
##############

AuthFileHandler.class = ch.ethz.sis.shared.log.standard.handlers.DailyRollingFileHandler
AuthFileHandler.logFileName = logs/openbis_auth.log
AuthFileHandler.maxLogFileSize = 10485760
AuthFileHandler.maxLogRotations = 10
AuthFileHandler.append = true
AuthFileHandler.level = INFO
AuthFileHandler.messagePattern = %d %-5p [%t] %c - %m%n

##############
# USAGE FILE HANDLER
##############

UsageFileHandler.class = ch.ethz.sis.shared.log.standard.handlers.DailyRollingFileHandler
UsageFileHandler.logFileName = logs/openbis_usage.log
UsageFileHandler.maxLogFileSize = 10485760
UsageFileHandler.maxLogRotations = 10
UsageFileHandler.append = true
UsageFileHandler.level = INFO
UsageFileHandler.messagePattern = %d %-5p [%t] %c - %m%n


##############
# EMAIL HANDLER
##############
#TODO
# same SMTPHandler from before (you must have smtphandler-*.jar on your classpath)
#EmailHandler.level               = INFO
#EmailHandler.class               = smtphandler.SMTPHandler
#EmailHandler.formatter           = java.util.logging.SimpleFormatter
#EmailHandler.bufferSize          = 512
#EmailHandler.smtpHost            = localhost
#EmailHandler.from                = openbis@localhost
#EmailHandler.to                  = openbis@localhost
#EmailHandler.subject             = ATTENTION: openBIS Server
#EmailHandler.evaluatorClass      = ch.systemsx.cisd.common.logging.AlwaysTrueTriggeringRecordEvaluator


##############
# LOGGER TO HANDLER MAPPINGS
##############

# NOTIFY category  write to DEFAULT file + send email

NOTIFY.level              = INFO
NOTIFY.handlerAliases           = defaultFileHandler
#,EmailHandler

# AUTH category = AUTH + USAGE files
AUTH.level                = INFO
AUTH.handlerAliases             = AuthFileHandler,UsageFileHandler

# TRACKING category = USAGE file
TRACKING.level            = INFO
TRACKING.handlerAliases         = UsageFileHandler

# STATUS category = console only
STATUS.level              = INFO
STATUS.handlerAliases           = consoleHandler

# ACCESS category = USAGE file
ACCESS.level              = INFO
ACCESS.handlerAliases           = UsageFileHandler

# silence HTTP-wire debug (only show SEVERE/errors)
httpclient.wire.level     = SEVERE

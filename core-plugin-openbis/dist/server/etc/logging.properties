#
#  Copyright ETH 2025 Zürich, Scientific IT Services
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
#

#############################################################
# JUL Log Levels (must use these exact names) and Log4j mapping
#
# OFF     = no logging                      | Log4j: OFF
# SEVERE  = serious failures, system errors | Log4j: ERROR
# WARNING = potential problems, recoverable | Log4j: WARN
# INFO    = general informational messages   | Log4j: INFO
# CONFIG  = static configuration messages    | Log4j: DEBUG
# FINE    = general debugging/tracing        | Log4j: DEBUG
# FINER   = more detailed tracing            | Log4j: TRACE
# FINEST  = most detailed, very verbose      | Log4j: TRACE
# ALL     = enable all logging               | Log4j: ALL
#############################################################


########################################
# Global settings
########################################

.global.level = INFO

# these handlers are bound to the root logger unless overridden below
.global.handlerAliases = DefaultFileHandler, ConsoleHandler, ResolvedPropertiesHandler


########################################
# HANDLER DEFINITIONS
########################################

# 0) Console
ConsoleHandler.class = ch.ethz.sis.shared.log.standard.handlers.ConsoleHandler
ConsoleHandler.level = INFO
ConsoleHandler.messagePattern = %d %-5p [%t] %c - %m%n
ConsoleHandler.encoding = UTF-8
ConsoleHandler.target = System.out

# 1) DEFAULT
DefaultFileHandler.class = ch.ethz.sis.shared.log.standard.handlers.DailyRollingFileHandler
DefaultFileHandler.logFileName = logs/openbis.log
#DefaultFileHandler.maxLogFileSize = 10485760
DefaultFileHandler.append = true
DefaultFileHandler.level = INFO
DefaultFileHandler.messagePattern = %d %-5p [%t] %c - %m%n

# 2) SERVICE_CALL
ServiceCallHandler.class = ch.systemsx.cisd.openbis.common.log.ServiceCallAppender
ServiceCallHandler.logFileName = logs/openbis_service_calls.log
#ServiceCallHandler.maxLogFileSize = 10485760
ServiceCallHandler.append = true
ServiceCallHandler.level = INFO
ServiceCallHandler.messagePattern = %d %-5p [%t] %c - %m%n

# 3) LONG_RUNNING_THREAD (openbis_long_running_threads.log)
LongRunningThreadHandler.class = ch.ethz.sis.shared.log.standard.handlers.DailyRollingFileHandler
LongRunningThreadHandler.logFileName = logs/openbis_long_running_threads.log
#LongRunningThreadHandler.maxLogFileSize = 10485760
LongRunningThreadHandler.append = true
LongRunningThreadHandler.level = INFO
LongRunningThreadHandler.messagePattern = %d %-5p [%t] %c - %m%n

# 4) DB_CONNECTIONS (openbis_db_connections.log)
DbConnectionsHandler.class = ch.systemsx.cisd.dbmigration.logging.DbConnectionLogHandler
DbConnectionsHandler.logFileName = logs/openbis_db_connections.log
#DbConnectionsHandler.maxLogFileSize = 10485760
DbConnectionsHandler.append = true
DbConnectionsHandler.level = INFO
DbConnectionsHandler.messagePattern = %d %-5p [%t] %c - %m%n

# 5) AUTH (openbis_auth.log)
AuthFileHandler.class = ch.ethz.sis.shared.log.standard.handlers.DailyRollingFileHandler
AuthFileHandler.logFileName = logs/openbis_auth.log
#AuthFileHandler.maxLogFileSize = 10485760
AuthFileHandler.append = true
AuthFileHandler.level = INFO
AuthFileHandler.messagePattern = %d %-5p [%t] %c - %m%n

# 6) USAGE (openbis_usage.log)
UsageFileHandler.class = ch.ethz.sis.shared.log.standard.handlers.DailyRollingFileHandler
UsageFileHandler.logFileName = logs/openbis_usage.log
#UsageFileHandler.maxLogFileSize = 10485760
UsageFileHandler.append = true
UsageFileHandler.level = INFO
UsageFileHandler.messagePattern = %d %-5p [%t] %c - %m%n

# 7) STDOUT (console)
#java.util.logging.ConsoleHandler.level     = INFO
#java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter

# 8) EMAIL (SMTPAppender equivalent)
#EmailHandler.level              = INFO
#EmailHandler.class              = smtphandler.SMTPHandler
#EmailHandler.formatter          = java.util.logging.SimpleFormatter
#EmailHandler.bufferSize         = 512
#EmailHandler.smtpHost           = localhost
#EmailHandler.from               = openbis@localhost
#EmailHandler.to                 = openbis@localhost
#EmailHandler.subject            = ATTENTION: openBIS Server
#EmailHandler.evaluatorClass     = ch.systemsx.cisd.common.logging.AlwaysTrueTriggeringRecordEvaluator

# 9) STARTUP PROPERTIES (startup_properties.log)
ResolvedPropertiesHandler.class = ch.ethz.sis.shared.log.standard.handlers.SingleFileHandler
ResolvedPropertiesHandler.level = INFO
ResolvedPropertiesHandler.append = false
ResolvedPropertiesHandler.maxLogFileSize = 10048576
ResolvedPropertiesHandler.filter = OPERATION.ExposablePropertyPlaceholderConfigurer
ResolvedPropertiesHandler.logFileName = logs/startup_properties.log
ResolvedPropertiesHandler.messagePattern = %d %-5p [%t] %c - %m%n

########################################
# LOGGER-TO-HANDLER MAPPINGS
########################################

# MACHINE.MonitoringPoolingDataSource ? DB_CONNECTIONS
MACHINE.MonitoringPoolingDataSource.level   = INFO
logger.MACHINE.MonitoringPoolingDataSource.handlerAliases= DbConnectionsHandler,DefaultFileHandler,ResolvedPropertiesHandler

# NOTIFY = DEFAULT + EMAIL
NOTIFY.level           = INFO
NOTIFY.handlerAliases        = DefaultFileHandler,ResolvedPropertiesHandler
 #,EmailHandler

# AUTH = AUTH + USAGE
AUTH.level             = INFO
AUTH.handlerAliases          = AuthFileHandler,UsageFileHandler,DefaultFileHandler,ResolvedPropertiesHandler

# TRACKING = USAGE + SERVICE_CALL
TRACKING.level         = INFO
TRACKING.handlerAliases      = UsageFileHandler,ServiceCallHandler,DefaultFileHandler,ResolvedPropertiesHandler

# ACCESS = USAGE + SERVICE_CALL
ACCESS.level           = INFO
ACCESS.handlerAliases        = UsageFileHandler,ServiceCallHandler,DefaultFileHandler,ResolvedPropertiesHandler

# ACCESS.LongRunningThreadLogger = LONG_RUNNING_THREAD
ACCESS.LongRunningThreadLogger.level = INFO
ACCESS.LongRunningThreadLogger.handlerAliases = LongRunningThreadHandler,DefaultFileHandler,ResolvedPropertiesHandler

# Suppress HTTP wire-level debug
httpclient.wire.level  = SEVERE
